<html>

<head>
  <script src="./dist/esbuild/tensor-diagrams.js"></script>
  <link rel='stylesheet' href='./src/diagram.css'>
</head>

<body>
  <div id="firstcontainer" class="equation">
    <div class="eq-diagram">
    </div>
    <div class="eq-elem"> = ∑_ij</div>
    <div class="eq-elem tensor-eq-x">x_i</div>
    <div class="eq-elem tensor-eq-A">A_ij</div>
    <div class="eq-elem tensor-eq-B">B_jk</div>
  </div>
  <div id="simpler" class="equation"></div>
  <div id="simpler-formula" class="equation"></div>
  <div id="trAB" class="equation"></div>
  <div id="tensorLabel" class="equation"></div>
  <div id="implicitdots" class="equation"></div>
  <script>
    const tensors = [
      TensorDiagram.createTensor(0, 0, "x", [
        { pos: "right", name: "i", showLabel: true },
      ]),
      TensorDiagram.createTensor(1, 0, "A", [
        { pos: "left", name: "i", showLabel: true },
        { pos: "right", name: "j", showLabel: true }
      ]),
      TensorDiagram.createTensor(2, 0, "B", [
        { pos: "left", name: "j", showLabel: true },
        { pos: "right", name: "k", showLabel: true }
      ]),
    ];

    const contractions = [
      { source: 0, target: 1, name: "i" },
      { source: 1, target: 2, name: "j" },
    ];

    const diagram = new TensorDiagram(tensors, contractions, []);
    diagram.setSize(220, 120).draw("#firstcontainer", false);

    TensorDiagram.new()
      .addTensor("x", "start", [], ["i"])
      .addTensor("A", "right", ["i"], ["j"])
      .addTensor("B", "right", ["j"], ["k"])
      .addContraction(0, 1, "i")
      .addContraction(1, 2, "j")
      .setSize(220, 120)
      .setColorScheme(['x'], ['red'], 'd3category10')
      .draw("#simpler");

    TensorDiagram.new()
      .addTensor("x", "start", [], ["i"], [], [], { labelPos: 'down' })
      .addTensor("A", "right", ["i"], ["j"], [], [], { showLabel: false, size: 40 })
      .addTensor("B", "right", ["j"], ["k"], [], [], { shape: 'triangleLeft', color: 'white' })
      .addContraction(0, 1, "i")
      .addContraction(1, 2, "j")
      .setSize(220, 120)
      .draw("#simpler-formula", true, [
        { name: "", label: "= ∑_ij" },
        { name: "x", label: "x_i" },
        { name: "A", label: "A_ij" },
        { name: "B", label: "B_jk" },
      ]);

    TensorDiagram.new()
      .addTensor("A", { x: 1, y: 0 }, ["i"], ["j"])
      .addTensor("B", "right", ["j"], ["i"])
      .addContraction(0, 1, "i", "down")
      .addContraction(0, 1, "j")
      .setSize(220, 120)
      .draw("#trAB");

    TensorDiagram.new()
      .addTensor("A", { x: 1, y: 0 }, [], [], [], [], { labelPos: 'up left' })
      .setSize(140, 120)
      .draw("#tensorLabel");

    TensorDiagram.new()
      .addTensor("x", "start", [], ["i"])
      .addTensor("A", "right", ["i"], ["j"])
      .addTensor("B", { x: 3, y: 0 }, ["j"], ["k"])
      .addTensor("C", { x: 2, y: 1 }, [], [], ["j"], ["l"], { labelPos: "center" })
      .addSummation("i")
      .addSummation("j", { x: 2, y: 0 })
      .addSummation("k")
      .setSize(300, 200)
      .draw("#implicitdots");

  </script>
</body>

</html>
